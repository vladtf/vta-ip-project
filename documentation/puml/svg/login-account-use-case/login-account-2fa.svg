<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="678px" preserveAspectRatio="none" style="width:979px;height:678px;background:#FFFFFF;" version="1.1" viewBox="0 0 979 678" width="979px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="67.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="27" y="566.0781"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="67.7988"/><rect fill="#FFFFFF" height="205.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="126.4199"/><rect fill="#FFFFFF" height="146.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="390.2148"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="595.3887"/><rect fill="#FFFFFF" height="146.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="688" y="155.7305"/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="688" y="419.5254"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="869" y="185.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="869" y="448.8359"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="32" x2="32" y1="36.4883" y2="642.6992"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="416.5" x2="416.5" y1="36.4883" y2="642.6992"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="692.5" x2="692.5" y1="36.4883" y2="642.6992"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="873.5" x2="873.5" y1="36.4883" y2="642.6992"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="947.5" x2="947.5" y1="36.4883" y2="642.6992"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="12" y="25.5352">Client</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="5" y="641.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="12" y="662.2344">Client</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="378.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="385.5" y="25.5352">Frontend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="378.5" y="641.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="385.5" y="662.2344">Frontend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="657.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="664.5" y="25.5352">Backend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="657.5" y="641.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="664.5" y="662.2344">Backend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="835.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="842.5" y="25.5352">Database</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="835.5" y="641.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="842.5" y="662.2344">Database</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="922.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="929.5" y="25.5352">SMTP</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="922.5" y="641.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="929.5" y="662.2344">SMTP</text><rect fill="#FFFFFF" height="67.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="27" y="566.0781"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="67.7988"/><rect fill="#FFFFFF" height="205.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="126.4199"/><rect fill="#FFFFFF" height="146.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="390.2148"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="412" y="595.3887"/><rect fill="#FFFFFF" height="146.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="688" y="155.7305"/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="688" y="419.5254"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="869" y="185.041"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="869" y="448.8359"/><polygon fill="#181818" points="400,63.7988,410,67.7988,400,71.7988,404,67.7988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="406" y1="67.7988" y2="67.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="39" y="63.0566">get login form</text><polygon fill="#181818" points="43,93.1094,33,97.1094,43,101.1094,39,97.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="37" x2="416" y1="97.1094" y2="97.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="49" y="92.3672">login form (HTML)</text><polygon fill="#181818" points="400,122.4199,410,126.4199,400,130.4199,404,126.4199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="406" y1="126.4199" y2="126.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="39" y="121.6777">enter data and click login</text><polygon fill="#181818" points="676,151.7305,686,155.7305,676,159.7305,680,155.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="682" y1="155.7305" y2="155.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="429" y="150.9883">HTTP request (POST /login)</text><polygon fill="#181818" points="857,181.041,867,185.041,857,189.041,861,185.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="698" x2="863" y1="185.041" y2="185.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="705" y="180.2988">get user</text><polygon fill="#181818" points="709,210.3516,699,214.3516,709,218.3516,705,214.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="703" x2="873" y1="214.3516" y2="214.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="715" y="209.6094">user</text><polygon fill="#181818" points="433,239.6621,423,243.6621,433,247.6621,429,243.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="427" x2="687" y1="243.6621" y2="243.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="439" y="238.9199">HTTP response (200)</text><polygon fill="#181818" points="936,268.9727,946,272.9727,936,276.9727,940,272.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="698" x2="942" y1="272.9727" y2="272.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="705" y="268.2305">send email with token to user</text><polygon fill="#181818" points="43,298.2832,33,302.2832,43,306.2832,39,302.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="37" x2="947" y1="302.2832" y2="302.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="49" y="297.541">email with token</text><polygon fill="#181818" points="43,327.5938,33,331.5938,43,335.5938,39,331.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="37" x2="416" y1="331.5938" y2="331.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="49" y="326.8516">success message (HTML)</text><polygon fill="#181818" points="43,356.9043,33,360.9043,43,364.9043,39,360.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="416" y1="360.9043" y2="360.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="49" y="356.1621">redirect to two-factor page</text><polygon fill="#181818" points="400,386.2148,410,390.2148,400,394.2148,404,390.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="406" y1="390.2148" y2="390.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="39" y="385.4727">enter token from email and click login</text><polygon fill="#181818" points="676,415.5254,686,419.5254,676,423.5254,680,419.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="422" x2="682" y1="419.5254" y2="419.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="429" y="414.7832">HTTP request (POST /login-two-factor)</text><polygon fill="#181818" points="857,444.8359,867,448.8359,857,452.8359,861,448.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="698" x2="863" y1="448.8359" y2="448.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="705" y="444.0938">get latest token for user</text><polygon fill="#181818" points="709,474.1465,699,478.1465,709,482.1465,705,478.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="703" x2="873" y1="478.1465" y2="478.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="715" y="473.4043">token</text><polygon fill="#181818" points="433,503.457,423,507.457,433,511.457,429,507.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="427" x2="692" y1="507.457" y2="507.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="439" y="502.7148">HTTP response (200) with JWT token</text><polygon fill="#181818" points="43,532.7676,33,536.7676,43,540.7676,39,536.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="37" x2="416" y1="536.7676" y2="536.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="49" y="532.0254">success message (HTML) with JWT token in local storage</text><polygon fill="#181818" points="48,562.0781,38,566.0781,48,570.0781,44,566.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="416" y1="566.0781" y2="566.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="54" y="561.3359">redirect to home page</text><polygon fill="#181818" points="400,591.3887,410,595.3887,400,599.3887,404,595.3887" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="37" x2="406" y1="595.3887" y2="595.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="44" y="590.6465">get home page</text><polygon fill="#181818" points="48,620.6992,38,624.6992,48,628.6992,44,624.6992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42" x2="416" y1="624.6992" y2="624.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="54" y="619.957">home page (HTML)</text><!--MD5=[43a7d81b422649004ec74d1f5867f864]
@startuml login-account-2fa

Client -> Frontend: get login form
activate Frontend
Frontend - -> Client: login form (HTML)
deactivate Frontend
Client -> Frontend: enter data and click login
activate Frontend
Frontend -> Backend: HTTP request (POST /login)
activate Backend
Backend -> Database: get user
activate Database
Database - -> Backend: user
deactivate Database
Backend - -> Frontend: HTTP response (200)
Backend -> SMTP: send email with token to user
SMTP - -> Client: email with token
deactivate Backend
Frontend - -> Client: success message (HTML)
deactivate Frontend
Frontend -> Client: redirect to two-factor page
Client -> Frontend: enter token from email and click login
activate Frontend
Frontend -> Backend: HTTP request (POST /login-two-factor)
activate Backend
Backend -> Database: get latest token for user
activate Database
Database - -> Backend: token
deactivate Database
Backend - -> Frontend: HTTP response (200) with JWT token
deactivate Backend
Frontend - -> Client: success message (HTML) with JWT token in local storage
deactivate Frontend
Frontend -> Client: redirect to home page
activate Client
Client -> Frontend: get home page
activate Frontend
Frontend - -> Client: home page (HTML)
deactivate Frontend

@enduml

PlantUML version 1.2022.7(Mon Aug 22 20:01:30 EEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: RO
--></g></svg>